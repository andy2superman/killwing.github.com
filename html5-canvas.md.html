<!DOCTYPE html>
<html>
<title>HTML5 Canvas</title>
<xmp theme="readable" style="display:none;">
http://chimera.labs.oreilly.com/books/1234000001654
http://www.w3.org/html/wg/drafts/2dcontext/html5_canvas/

## 1. Introduction to HTML5 Canvas
HTML5 Canvas是屏幕上可被JavaScript操纵的立即模式的位图区域。当调用Canvas JavaScript API的时候，canvas会在每一帧上完全重绘位图。这和在保留模式操作的Flash, Silverlight或SVG不一样，图形渲染器保存了一个对象的显示列表，对象根据其代码里设置的属性显示在屏幕上。

HTML5是一个在免费许可条款下开发的开放网络平台。

基本的HTML5页面：
```
<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CH1EX1: Basic Hello World HTML Page</title>
</head>
<body>
Hello World!
</body>
</html>
```

测试浏览器支持：
```
function canvasSupport() {
    return !!document.createElement('canvas').getContext;
}
```
兼容性测试库：http://www.modernizr.com/

所有在canvas上的操作都要通过context对象（`CanvasRenderingContext2D`, 这里只涉及2D）来完成：
```
var theCanvas = document.getElementById("canvasOne");
var context = theCanvas.getContext("2d");
```

`CanvasRenderingContext2D`使用笛卡尔座标系，原点(0,0)在左上角，并向右下角增长。

context有个当前绘制状态，全局地对整个canvas起作用，包括：

* 变换矩阵：用来scale, rotate, transform和translate的方法。
* 裁剪区域：由clip方法创建。
* 属性：包括strokeStyle, fillStyle, globalAlpha, lineWidth, lineCap, lineJoin, miterLimit, shadowOffsetX, shadowOffsetY, shadowBlur, shadowColor, globalCompositeOperation, font, textAlign, textBaseline.

canvas对象的属性和方法：

* height: canvas的高度
* width: canvas的宽度
* getContext: 取得context对象。
* toDataURL: 把canvas转化成base64字符串表示，以不同的MIME类型作为参数，如image/png, image/jpeg。
* toBlob: 返回一个图像文件的引用。

`window.requestAnimationFrame`: 告诉程序浏览器已经准备好可以渲染动画的新的一帧了：
```
(function animationloop(){
    window.requestAnimationFrame(animationloop); // 或 window.setTimeout(animationloop, 1000 / 60); // 1秒60帧
    render();
})();
```


## 2. Drawing on the Canvas
矩形：
`fillRect(x, y, width, height)`
`strokeRect(x, y,width, height)`
`clearRect(x, y, width, height)`

路径：
`beginPath()`
`closePath()`
`moveTo(x, y)`
`lineTo(x, y)`
`stroke()`

曲线：
`arc(x, y, radius, startAngle, endAngle, anticlockwise)`
`arcTo(x1, y1, x2, y2, radius)`
`bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y)`
`quadraticCurveTo(cpx, cpy, x, y)`

属性：
fillStyle: 填充样式
lineCap: 端点形状 butt/round/square
lineJoin: 连接处形状 miter/bevel/round
miterLimit: 斜接的比例，默认10
lineWidth: 线宽，默认1.0
strokeStyle: 线条样式

当前路径和当前位图不属于当前的context状态。
当前context状态可以像栈一样保存和恢复：`context.save()`, `context.restore()`


</xmp>
<script src="js/strapdown.js"></script>
</html>
